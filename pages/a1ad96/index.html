<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>多级反馈队列 | Pursuit&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="随便写写">
    <meta name="keywords" content="python,Go,C++,git,github,markdown,database,mysql,redis">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.a3990aec.css" as="style"><link rel="preload" href="/assets/js/app.81b3082f.js" as="script"><link rel="preload" href="/assets/js/4.71a85121.js" as="script"><link rel="preload" href="/assets/js/1.4a1189e9.js" as="script"><link rel="preload" href="/assets/js/3.bca043f9.js" as="script"><link rel="preload" href="/assets/js/106.a6484004.js" as="script"><link rel="preload" href="/assets/js/20.bc1029fc.js" as="script"><link rel="prefetch" href="/assets/js/10.ce2d8b4d.js"><link rel="prefetch" href="/assets/js/100.5fc69515.js"><link rel="prefetch" href="/assets/js/101.a1952818.js"><link rel="prefetch" href="/assets/js/102.37c5ab3b.js"><link rel="prefetch" href="/assets/js/103.c8b8a569.js"><link rel="prefetch" href="/assets/js/104.e1ff2033.js"><link rel="prefetch" href="/assets/js/105.a55146b9.js"><link rel="prefetch" href="/assets/js/107.280ec1ce.js"><link rel="prefetch" href="/assets/js/108.b5be7ef3.js"><link rel="prefetch" href="/assets/js/109.2a0ff093.js"><link rel="prefetch" href="/assets/js/11.87208a0c.js"><link rel="prefetch" href="/assets/js/110.a12d87f7.js"><link rel="prefetch" href="/assets/js/111.42cec442.js"><link rel="prefetch" href="/assets/js/112.2522cc6d.js"><link rel="prefetch" href="/assets/js/113.d446f324.js"><link rel="prefetch" href="/assets/js/114.6b72f63c.js"><link rel="prefetch" href="/assets/js/115.bd818aa2.js"><link rel="prefetch" href="/assets/js/116.6d2596c7.js"><link rel="prefetch" href="/assets/js/117.1f0956b2.js"><link rel="prefetch" href="/assets/js/118.19da43e0.js"><link rel="prefetch" href="/assets/js/119.be38f716.js"><link rel="prefetch" href="/assets/js/12.7f5cceef.js"><link rel="prefetch" href="/assets/js/120.84d34c42.js"><link rel="prefetch" href="/assets/js/121.25c5076a.js"><link rel="prefetch" href="/assets/js/122.69248f5a.js"><link rel="prefetch" href="/assets/js/123.b13a08cd.js"><link rel="prefetch" href="/assets/js/124.499d4b13.js"><link rel="prefetch" href="/assets/js/125.2757d8a6.js"><link rel="prefetch" href="/assets/js/126.4d189f96.js"><link rel="prefetch" href="/assets/js/127.bb37ce14.js"><link rel="prefetch" href="/assets/js/128.1f3c6eb8.js"><link rel="prefetch" href="/assets/js/129.bd273625.js"><link rel="prefetch" href="/assets/js/13.f2cea533.js"><link rel="prefetch" href="/assets/js/130.fdd8a42b.js"><link rel="prefetch" href="/assets/js/131.0c459113.js"><link rel="prefetch" href="/assets/js/132.d50b04f9.js"><link rel="prefetch" href="/assets/js/133.af665afb.js"><link rel="prefetch" href="/assets/js/134.cf7f235d.js"><link rel="prefetch" href="/assets/js/135.a912a755.js"><link rel="prefetch" href="/assets/js/136.8c0e510f.js"><link rel="prefetch" href="/assets/js/137.bd2aba16.js"><link rel="prefetch" href="/assets/js/138.e86e1b2d.js"><link rel="prefetch" href="/assets/js/139.963e59cc.js"><link rel="prefetch" href="/assets/js/14.f8459573.js"><link rel="prefetch" href="/assets/js/140.8ef8042a.js"><link rel="prefetch" href="/assets/js/141.6c8da0c4.js"><link rel="prefetch" href="/assets/js/142.d0f49248.js"><link rel="prefetch" href="/assets/js/143.2946aa54.js"><link rel="prefetch" href="/assets/js/144.a4f13cc6.js"><link rel="prefetch" href="/assets/js/145.388d3c0a.js"><link rel="prefetch" href="/assets/js/146.d572180c.js"><link rel="prefetch" href="/assets/js/147.3af2e140.js"><link rel="prefetch" href="/assets/js/148.6bf92ac3.js"><link rel="prefetch" href="/assets/js/149.551597e5.js"><link rel="prefetch" href="/assets/js/15.06cd6cc8.js"><link rel="prefetch" href="/assets/js/150.5576b2f7.js"><link rel="prefetch" href="/assets/js/151.8f55fefa.js"><link rel="prefetch" href="/assets/js/152.f7cb0a56.js"><link rel="prefetch" href="/assets/js/153.e5cdf8a3.js"><link rel="prefetch" href="/assets/js/154.d8d5619c.js"><link rel="prefetch" href="/assets/js/155.788491cb.js"><link rel="prefetch" href="/assets/js/156.41526dc0.js"><link rel="prefetch" href="/assets/js/157.3fa615c8.js"><link rel="prefetch" href="/assets/js/158.66fa5e20.js"><link rel="prefetch" href="/assets/js/159.c756408e.js"><link rel="prefetch" href="/assets/js/16.33942615.js"><link rel="prefetch" href="/assets/js/160.86d9bf45.js"><link rel="prefetch" href="/assets/js/161.6b3759cc.js"><link rel="prefetch" href="/assets/js/162.a3bc9bd2.js"><link rel="prefetch" href="/assets/js/163.0f3d6ce9.js"><link rel="prefetch" href="/assets/js/164.5add4572.js"><link rel="prefetch" href="/assets/js/165.1e39153f.js"><link rel="prefetch" href="/assets/js/166.0e2173ed.js"><link rel="prefetch" href="/assets/js/167.8a49eeec.js"><link rel="prefetch" href="/assets/js/168.8e145333.js"><link rel="prefetch" href="/assets/js/169.959bab4d.js"><link rel="prefetch" href="/assets/js/17.da2e0126.js"><link rel="prefetch" href="/assets/js/170.185bb62e.js"><link rel="prefetch" href="/assets/js/171.d05c7432.js"><link rel="prefetch" href="/assets/js/172.4eabe97c.js"><link rel="prefetch" href="/assets/js/173.67c548c5.js"><link rel="prefetch" href="/assets/js/174.6d914b18.js"><link rel="prefetch" href="/assets/js/175.bf248653.js"><link rel="prefetch" href="/assets/js/176.f71df578.js"><link rel="prefetch" href="/assets/js/177.59650967.js"><link rel="prefetch" href="/assets/js/178.7b9afa74.js"><link rel="prefetch" href="/assets/js/179.7e2d3c21.js"><link rel="prefetch" href="/assets/js/18.a39b8ae2.js"><link rel="prefetch" href="/assets/js/180.6234a9d9.js"><link rel="prefetch" href="/assets/js/181.2e34299c.js"><link rel="prefetch" href="/assets/js/182.89cd99ff.js"><link rel="prefetch" href="/assets/js/183.57b80473.js"><link rel="prefetch" href="/assets/js/19.1760f287.js"><link rel="prefetch" href="/assets/js/2.8e76b5b7.js"><link rel="prefetch" href="/assets/js/21.4b161474.js"><link rel="prefetch" href="/assets/js/22.69d29451.js"><link rel="prefetch" href="/assets/js/23.2a87052f.js"><link rel="prefetch" href="/assets/js/24.6beeaf9b.js"><link rel="prefetch" href="/assets/js/25.e9d4e312.js"><link rel="prefetch" href="/assets/js/26.c128f1d5.js"><link rel="prefetch" href="/assets/js/27.2bab9253.js"><link rel="prefetch" href="/assets/js/28.0b0ea581.js"><link rel="prefetch" href="/assets/js/29.71a2a1e9.js"><link rel="prefetch" href="/assets/js/30.11fd1987.js"><link rel="prefetch" href="/assets/js/31.92abb231.js"><link rel="prefetch" href="/assets/js/32.27d7c672.js"><link rel="prefetch" href="/assets/js/33.9f002fe8.js"><link rel="prefetch" href="/assets/js/34.39abd7b3.js"><link rel="prefetch" href="/assets/js/35.a54492ae.js"><link rel="prefetch" href="/assets/js/36.1b3ef370.js"><link rel="prefetch" href="/assets/js/37.3dda47b6.js"><link rel="prefetch" href="/assets/js/38.3dc3656a.js"><link rel="prefetch" href="/assets/js/39.78160c0e.js"><link rel="prefetch" href="/assets/js/40.382841f8.js"><link rel="prefetch" href="/assets/js/41.885f2f51.js"><link rel="prefetch" href="/assets/js/42.a794deca.js"><link rel="prefetch" href="/assets/js/43.bd06b1c5.js"><link rel="prefetch" href="/assets/js/44.c5b9fce0.js"><link rel="prefetch" href="/assets/js/45.8e169e05.js"><link rel="prefetch" href="/assets/js/46.907fb663.js"><link rel="prefetch" href="/assets/js/47.b494d092.js"><link rel="prefetch" href="/assets/js/48.7c4206ed.js"><link rel="prefetch" href="/assets/js/49.16bab940.js"><link rel="prefetch" href="/assets/js/5.780a742d.js"><link rel="prefetch" href="/assets/js/50.bf2afa43.js"><link rel="prefetch" href="/assets/js/51.0a1e84c2.js"><link rel="prefetch" href="/assets/js/52.59a39ef7.js"><link rel="prefetch" href="/assets/js/53.572697e9.js"><link rel="prefetch" href="/assets/js/54.fc2487d6.js"><link rel="prefetch" href="/assets/js/55.3db8ca64.js"><link rel="prefetch" href="/assets/js/56.996e8090.js"><link rel="prefetch" href="/assets/js/57.23b90d70.js"><link rel="prefetch" href="/assets/js/58.9ad3667d.js"><link rel="prefetch" href="/assets/js/59.0a608087.js"><link rel="prefetch" href="/assets/js/6.6c206683.js"><link rel="prefetch" href="/assets/js/60.3acec2d6.js"><link rel="prefetch" href="/assets/js/61.c8057e71.js"><link rel="prefetch" href="/assets/js/62.a15c3ffa.js"><link rel="prefetch" href="/assets/js/63.f03ccc98.js"><link rel="prefetch" href="/assets/js/64.0eec6ac5.js"><link rel="prefetch" href="/assets/js/65.a9fd4223.js"><link rel="prefetch" href="/assets/js/66.ddab8a29.js"><link rel="prefetch" href="/assets/js/67.3858f190.js"><link rel="prefetch" href="/assets/js/68.07d001e3.js"><link rel="prefetch" href="/assets/js/69.bd328549.js"><link rel="prefetch" href="/assets/js/7.03420b55.js"><link rel="prefetch" href="/assets/js/70.d651fd44.js"><link rel="prefetch" href="/assets/js/71.bf90808a.js"><link rel="prefetch" href="/assets/js/72.0a8c31e9.js"><link rel="prefetch" href="/assets/js/73.8cd8cb52.js"><link rel="prefetch" href="/assets/js/74.e63cfed2.js"><link rel="prefetch" href="/assets/js/75.1704aadb.js"><link rel="prefetch" href="/assets/js/76.c3ee36bc.js"><link rel="prefetch" href="/assets/js/77.4d5c1e59.js"><link rel="prefetch" href="/assets/js/78.e06e8d1f.js"><link rel="prefetch" href="/assets/js/79.3bce4a31.js"><link rel="prefetch" href="/assets/js/80.baf3a629.js"><link rel="prefetch" href="/assets/js/81.1b7d14fe.js"><link rel="prefetch" href="/assets/js/82.e48f8a69.js"><link rel="prefetch" href="/assets/js/83.f6385d17.js"><link rel="prefetch" href="/assets/js/84.7ebf4f02.js"><link rel="prefetch" href="/assets/js/85.ef90f7a4.js"><link rel="prefetch" href="/assets/js/86.6cbc081e.js"><link rel="prefetch" href="/assets/js/87.ec5eefd3.js"><link rel="prefetch" href="/assets/js/88.b868526a.js"><link rel="prefetch" href="/assets/js/89.bfd42e8a.js"><link rel="prefetch" href="/assets/js/90.3e979172.js"><link rel="prefetch" href="/assets/js/91.840a99e2.js"><link rel="prefetch" href="/assets/js/92.dc6ea2f3.js"><link rel="prefetch" href="/assets/js/93.7b66f316.js"><link rel="prefetch" href="/assets/js/94.1afdc843.js"><link rel="prefetch" href="/assets/js/95.30a85f63.js"><link rel="prefetch" href="/assets/js/96.72514b40.js"><link rel="prefetch" href="/assets/js/97.69d2b31d.js"><link rel="prefetch" href="/assets/js/98.7c6ea3db.js"><link rel="prefetch" href="/assets/js/99.2626bb56.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.caeb3b49.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a3990aec.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpeg" alt="Pursuit's blog" class="logo"> <span class="site-name can-hide">Pursuit's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><a href="/develop/" class="link-title">开发</a> <span class="title" style="display:none;">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/develop/language/" class="nav-link">编程语言</a></li><li class="dropdown-item"><!----> <a href="/develop/framework/" class="nav-link">开发框架</a></li><li class="dropdown-item"><!----> <a href="/develop/algorithm/" class="nav-link">数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/develop/storage/" class="nav-link">数据存储</a></li><li class="dropdown-item"><!----> <a href="/develop/system/" class="nav-link">系统架构</a></li><li class="dropdown-item"><!----> <a href="/develop/network/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/develop/cloud/" class="nav-link">云原生</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tool/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tool/vcs/" class="nav-link">版本控制</a></li><li class="dropdown-item"><!----> <a href="/tool/network/" class="nav-link">网络工具</a></li><li class="dropdown-item"><!----> <a href="/tool/develop/" class="nav-link">开发工具</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><a href="/note/" class="link-title">学习笔记</a> <span class="title" style="display:none;">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/paper/" class="nav-link">学术搬砖</a></li><li class="dropdown-item"><!----> <a href="/note/project/" class="nav-link">实践项目</a></li><li class="dropdown-item"><!----> <a href="/note/lecture/" class="nav-link">讲座研讨</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活杂谈" class="dropdown-title"><a href="/life/" class="link-title">生活杂谈</a> <span class="title" style="display:none;">生活杂谈</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/life/year/" class="nav-link">随写编年</a></li><li class="dropdown-item"><!----> <a href="/life/youth/" class="nav-link">追忆青春</a></li><li class="dropdown-item"><!----> <a href="/life/travel/" class="nav-link">旅行日记</a></li><li class="dropdown-item"><!----> <a href="/life/art/" class="nav-link">文艺时光</a></li><li class="dropdown-item"><!----> <a href="/life/cook/" class="nav-link">烹调分享</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="资源收藏" class="dropdown-title"><a href="/resource/" class="link-title">资源收藏</a> <span class="title" style="display:none;">资源收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/resource/website/" class="nav-link">实用网站</a></li><li class="dropdown-item"><!----> <a href="/resource/project/" class="nav-link">优秀项目</a></li><li class="dropdown-item"><!----> <a href="/resource/study/" class="nav-link">学习资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/more/interview/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/more/tip/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/more/blog/" class="nav-link">博客相关</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friend/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/unique-pure/my-vdoing-blog-template" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.jpeg"> <div class="blogger-info"><h3>Pursuit</h3> <span>但行好事，莫问前程</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><a href="/develop/" class="link-title">开发</a> <span class="title" style="display:none;">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/develop/language/" class="nav-link">编程语言</a></li><li class="dropdown-item"><!----> <a href="/develop/framework/" class="nav-link">开发框架</a></li><li class="dropdown-item"><!----> <a href="/develop/algorithm/" class="nav-link">数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/develop/storage/" class="nav-link">数据存储</a></li><li class="dropdown-item"><!----> <a href="/develop/system/" class="nav-link">系统架构</a></li><li class="dropdown-item"><!----> <a href="/develop/network/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/develop/cloud/" class="nav-link">云原生</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tool/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tool/vcs/" class="nav-link">版本控制</a></li><li class="dropdown-item"><!----> <a href="/tool/network/" class="nav-link">网络工具</a></li><li class="dropdown-item"><!----> <a href="/tool/develop/" class="nav-link">开发工具</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><a href="/note/" class="link-title">学习笔记</a> <span class="title" style="display:none;">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/paper/" class="nav-link">学术搬砖</a></li><li class="dropdown-item"><!----> <a href="/note/project/" class="nav-link">实践项目</a></li><li class="dropdown-item"><!----> <a href="/note/lecture/" class="nav-link">讲座研讨</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活杂谈" class="dropdown-title"><a href="/life/" class="link-title">生活杂谈</a> <span class="title" style="display:none;">生活杂谈</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/life/year/" class="nav-link">随写编年</a></li><li class="dropdown-item"><!----> <a href="/life/youth/" class="nav-link">追忆青春</a></li><li class="dropdown-item"><!----> <a href="/life/travel/" class="nav-link">旅行日记</a></li><li class="dropdown-item"><!----> <a href="/life/art/" class="nav-link">文艺时光</a></li><li class="dropdown-item"><!----> <a href="/life/cook/" class="nav-link">烹调分享</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="资源收藏" class="dropdown-title"><a href="/resource/" class="link-title">资源收藏</a> <span class="title" style="display:none;">资源收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/resource/website/" class="nav-link">实用网站</a></li><li class="dropdown-item"><!----> <a href="/resource/project/" class="nav-link">优秀项目</a></li><li class="dropdown-item"><!----> <a href="/resource/study/" class="nav-link">学习资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/more/interview/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/more/tip/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/more/blog/" class="nav-link">博客相关</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friend/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/unique-pure/my-vdoing-blog-template" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编程语言</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>开发框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构与算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据存储</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>系统架构</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>操作系统</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/77a74b/" class="sidebar-link">进程介绍</a></li><li><a href="/pages/1d4493/" class="sidebar-link">进程API</a></li><li><a href="/pages/4b8a3a/" class="sidebar-link">有限直接执行</a></li><li><a href="/pages/f0c724/" class="sidebar-link">CPU调度</a></li><li><a href="/pages/a1ad96/" aria-current="page" class="active sidebar-link">多级反馈队列</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/a1ad96/#_1-note-translation" class="sidebar-link">1 Note/Translation</a></li><li class="sidebar-sub-header level2"><a href="/pages/a1ad96/#_2-program-explanation" class="sidebar-link">2 Program Explanation</a></li><li class="sidebar-sub-header level2"><a href="/pages/a1ad96/#_3-qa" class="sidebar-link">3 QA</a></li></ul></li><li><a href="/pages/40a229/" class="sidebar-link">比例份额调度</a></li><li><a href="/pages/326999/" class="sidebar-link">多CPU调度</a></li><li><a href="/pages/23b20c/" class="sidebar-link">地址空间</a></li><li><a href="/pages/174348/" class="sidebar-link">内存API</a></li><li><a href="/pages/542fcd/" class="sidebar-link">地址转换</a></li><li><a href="/pages/506cee/" class="sidebar-link">段</a></li><li><a href="/pages/d34e64/" class="sidebar-link">空闲空间管理</a></li><li><a href="/pages/69f0fb/" class="sidebar-link">页</a></li><li><a href="/pages/fe36b0/" class="sidebar-link">快表</a></li><li><a href="/pages/165f2d/" class="sidebar-link">高级页表</a></li><li><a href="/pages/65f57a/" class="sidebar-link">页面交换</a></li><li><a href="/pages/aeb7cb/" class="sidebar-link">交换策略</a></li><li><a href="/pages/9f0f28/" class="sidebar-link">完整VM系统</a></li><li><a href="/pages/1ef559/" class="sidebar-link">并发和线程</a></li><li><a href="/pages/2994ff/" class="sidebar-link">线程API</a></li><li><a href="/pages/fe4f25/" class="sidebar-link">锁</a></li><li><a href="/pages/396fa2/" class="sidebar-link">锁定数据结构</a></li><li><a href="/pages/463259/" class="sidebar-link">条件变量</a></li><li><a href="/pages/adf4ea/" class="sidebar-link">信号量</a></li><li><a href="/pages/a9671b/" class="sidebar-link">并发bug</a></li><li><a href="/pages/19d9ef/" class="sidebar-link">基于事件的并发</a></li><li><a href="/pages/628c92/" class="sidebar-link">IO设备</a></li><li><a href="/pages/8d5e59/" class="sidebar-link">硬盘驱动器</a></li><li><a href="/pages/04dd86/" class="sidebar-link">廉价磁盘冗余阵列</a></li><li><a href="/pages/1539cb/" class="sidebar-link">文件和目录</a></li><li><a href="/pages/a2ee8a/" class="sidebar-link">文件系统实现</a></li><li><a href="/pages/61d032/" class="sidebar-link">快速文件系统</a></li><li><a href="/pages/d2b72b/" class="sidebar-link">FSCK和日志</a></li><li><a href="/pages/abc8b5/" class="sidebar-link">日志结构文件系统</a></li><li><a href="/pages/b0802a/" class="sidebar-link">基于闪存的SSD</a></li><li><a href="/pages/812baf/" class="sidebar-link">数据完整性和保护</a></li><li><a href="/pages/5fb229/" class="sidebar-link">分布式系统</a></li><li><a href="/pages/627a30/" class="sidebar-link">网络文件系统</a></li><li><a href="/pages/acfea7/" class="sidebar-link">Andrew文件系统</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>分布式系统</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>云原生</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/develop/#开发" data-v-06225672>开发</a></li><li data-v-06225672><a href="/develop/#系统架构" data-v-06225672>系统架构</a></li><li data-v-06225672><a href="/develop/#操作系统" data-v-06225672>操作系统</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/unique-pure" target="_blank" title="作者" class="beLink" data-v-06225672>Pursuit</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-04-25</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">多级反馈队列<!----></h1>  <div class="theme-vdoing-content content__default"><p><a href="https://github.com/unique-pure/ostep/tree/main/Virtualization/05.Multi-level%20Feedback" target="_blank" rel="noopener noreferrer">github地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_1-note-translation"><a href="#_1-note-translation" class="header-anchor">#</a> 1 Note/Translation</h2> <ul><li><p>基本规则</p> <p>MLFQ有许多不同的队列，每个队列分配了不同的优先级。在任何给定时间，准备运行的作业都位于单个队列上。 MLFQ 使用优先级来决定在给定时间应运行哪个作业：选择运行具有较高优先级的作业（即较高队列上的作业）。当然，一个队列上可能有多个作业，即具有相同的优先级，这种情况则对这些工作使用RR调度。则MLFQ基本规则如下：</p> <ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule </mtext><mn>1</mn><mo>:</mo><mtext>If Priority(A)&gt;Priority(B),A runs (B doesn’t).</mtext></mrow><annotation encoding="application/x-tex">\text{Rule}\space1:\text{If Priority(A)&gt;Priority(B),A runs (B doesn't).}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Rule</span></span><span class="mspace"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">If Priority(A)&gt;Priority(B),A runs (B doesn’t).</span></span></span></span></span></li> <li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule </mtext><mn>1</mn><mo>:</mo><mtext>If Priority(A)=Priority(B),A and B run in RR.</mtext></mrow><annotation encoding="application/x-tex">\text{Rule}\space1:\text{If Priority(A)=Priority(B),A and B run in RR.}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Rule</span></span><span class="mspace"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">If Priority(A)=Priority(B),A and B run in RR.</span></span></span></span></span></li></ul></li> <li><p>MLFQ例子</p> <p>如果我们要展示给定时刻队列的样子，我们可能会看到如下所示的内容（图 8.1）。图中，两个作业（A 和 B）的优先级最高，作业 C 处于中间，作业 D 的优先级最低。鉴于我们目前对 MLFQ 工作原理的了解，调度程序只会在 A 和 B 之间交替时间片，因为它们是系统中优先级最高的作业；可怜的工作 C 和 D 根本无法运行！</p> <img src="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/MLFQ-simple-example.png" alt="image-20240327093937017" style="zoom:50%;"></li> <li><p>尝试#1：怎么改变作业的优先级</p> <p>现在，我们必须决定 MLFQ 将如何在作业的生命周期内更改作业的优先级（以及它所在的队列）。为此，我们必须牢记我们的工作负载：短期运行的交互式作业（可能经常放弃 CPU），以及一些需要大量 CPU 时间但运行时间较长的“CPU 密集型”作业。其中响应时间并不重要。这是我们对优先级调整算法的第一次尝试：</p> <ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule 3: When a job enters the system, it is placed at the highest priority (the topmost queue).</mtext></mrow><annotation encoding="application/x-tex">\text{Rule 3: When a job enters the system, it is placed at the highest
  priority (the topmost queue).}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Rule 3: When a job enters the system, it is placed at the highest priority (the topmost queue).</span></span></span></span></span></li> <li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule 4a: If a job uses up an entire time slice while running, its pri- ority is reduced (i.e., it moves down one queue).</mtext></mrow><annotation encoding="application/x-tex">\text{Rule 4a: If a job uses up an entire time slice while running, its pri-
  ority is reduced (i.e., it moves down one queue).}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Rule 4a: If a job uses up an entire time slice while running, its pri- ority is reduced (i.e., it moves down one queue).</span></span></span></span></span></li> <li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule 4b: If a job gives up the CPU before the time slice is up, it stays at the same priority level.</mtext></mrow><annotation encoding="application/x-tex">\text{Rule 4b: If a job gives up the CPU before the time slice is up, it stays
  at the same priority level.}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Rule 4b: If a job gives up the CPU before the time slice is up, it stays at the same priority level.</span></span></span></span></span></li></ul></li> <li><p>例子#1.1：单个长时间运行的作业</p> <p>首先，我们来看看当系统中有一项长期运行的工作时会发生什么情况。下图显示了在三队列调度程序中该作业随时间发生的变化。</p> <img src="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Long-running%20Job%20Over%20Time.png" alt="image-20240327094644615" style="zoom:50%;"> <p>如示例所示，作业以最高优先级（Q2）进入。经过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>10ms</mtext></mrow><annotation encoding="application/x-tex">\text{10ms}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord text"><span class="mord">10ms</span></span></span></span></span> 的单个时间片后，调度程序将作业的优先级降低了一个，因此作业的优先级为 Q1。在 Q1 上运行一个时间片后，作业最终被降到系统中的最低优先级（Q0），并保持不变。</p></li> <li><p>例子#1.2：加入一个短作业</p> <p>在这个例子中，有两个作业：A是一个长期运行的CPU密集型作业，B是一个短期运行的交互作业。假设A已经运行了一段时间，然后B才到达，这样会发生什么？MLFQ是否会近似于B的SJF？</p> <p>如下图所示，A（黑色显示）在最低优先级队列中运行（任何长期运行的 CPU 密集型作业都是如此）；B（灰色显示）在 T = 100 时到达，因此会插入到最高队列，由于其运行时间很短（仅20ms），B 在到达底层队列之前完成，分两个时间片；然后 A 恢复运行（低优先级）。</p> <img src="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Along" alt="image-20240327095115109" style="zoom:50%;"> <p>从这个例子中，你有望理解算法的一个主要目标：因为它不知道一项作业是短作业还是长期作业，所以它首先假定它可能是短作业，从而给予该作业高优先级。如果它确实是短作业，它就会快速运行并完成；如果它不是短作业，它就会在队列中缓慢移动，从而很快证明自己是一个长期运行的更类似批处理的进程。通过这种方式，MLFQ 近似于 SJF。</p></li> <li><p>例子#1.3：关于I/O</p> <p>如上文规则 4b 所述，如果进程在用完其时间片之前放弃了处理器，我们会将其保持在相同的优先级。这条规则的用意很简单：例如，如果一个交互式作业正在进行大量的 I/O（比如等待键盘或鼠标的用户输入），那么它就会在其时间片完成之前放弃 CPU；在这种情况下，我们不希望惩罚该作业，因此只需将其保持在同一优先级即可。</p> <p>下图举例说明了这种方法的工作原理，交互式作业 B（灰色显示）只需要 CPU 1 ms，然后执行 I/O，与长期运行的批处理作业 A（黑色显示）争夺 CPU。MLFQ 方法将 B 保持在最高优先级，因为 B 一直在释放 CPU；如果 B 是交互式作业，MLFQ 将进一步实现快速运行交互式作业的目标。</p> <p><img src="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/A" alt="image-20240327113455587"></p></li> <li><p>我们现在设计的MLFQ存在的问题</p> <p>这样，我们就有了一个基本的 MLFQ。它似乎做得相当不错，在长时间运行的作业之间公平地共享 CPU，并让短时间或 I/O 密集型交互式作业快速运行。遗憾的是，我们迄今为止开发的方法存在严重缺陷。</p> <ol><li>饥饿问题：如果系统存在太多交互作业，它们将会共同消耗所有CPU时间，这样长时间运行的作业将不会获得任何CPU时间（即饥饿）。</li> <li>欺骗调度程序：聪明的用户可以重写程序，玩弄调度程序。即是指偷偷摸摸地欺骗调度程序，让调度程序给你分配更多的资源。我们所描述的算法很容易受到以下攻击：在时间片结束前，进行一次 I/O 操作（对某个你并不关心的文件），从而放弃 CPU；这样做可以让你保持在同一队列中，从而获得更多的 CPU 时间。如果操作得当（例如，运行 99% 的时间片后才放弃 CPU），作业几乎可以垄断 CPU。</li> <li>程序行为改变：一个程序可能会随着时间的推移而改变其行为；原来的 CPU 约束可能会过渡到交互阶段。采用我们目前的方法，这样的作业就会倒霉，不会像系统中的其他交互式作业一样得到处理。</li></ol></li> <li><p>尝试#2：优先级提升</p> <p>让我们试着改变规则，看看能否避免 &quot;饥饿 &quot;问题。为了保证占用 CPU 的作业能取得一些进展（即使进展不大），我们可以做些什么？简单来说，就是定期提升系统中所有作业的优先级。实现这一点的方法有很多，但我们只需做一件简单的事：把所有作业都扔到最上面的队列中；因此，我们需要一条新规则：</p> <ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule 5: After some time period S, move all the jobs in the system to the topmost queue.</mtext></mrow><annotation encoding="application/x-tex">\text{Rule 5: After some time period S, move all the jobs in the system
  to the topmost queue.}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Rule 5: After some time period S, move all the jobs in the system to the topmost queue.</span></span></span></span></span></li></ul> <p>我们的新规则同时解决了两个问题。首先，保证了进程不会饥饿：作业排在队列的最前面，就能与其他高优先级作业以循环方式共享 CPU，从而最终获得服务。其次，如果受 CPU 限制的作业已开始交互，调度程序会在其获得优先级提升后对其进行适当处理。</p></li> <li><p>例子#2.1：竞争CPU</p> <p>在这种情况下，我们仅展示一个长时间运行的作业与两个短时间运行的交互式作业竞争 CPU 时的行为。下图显示了两个图表。在左边，没有优先级提升，因此一旦两个短期作业到达，长期运行的作业就会陷入饥饿；右边，每 50 毫秒就有一次优先级提升（这个值可能太小，但这里用于示例），因此我们至少保证长时间运行的作业会取得一些进展，提升到每 50 毫秒设置一次最高优先级，从而定期运行。</p> <img src="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Without(Left)-and-With(right)-Priority-Boost.png" alt="image-20240327124352031" style="zoom:50%;"> <p>当然，增加时间段S会带来一个明显的问题：S应该设置为什么？ John Ousterhout，一位受人尊敬的系统研究员 ，过去常常将系统中的此类值称为“巫术常量”，因为它们似乎需要某种形式的黑魔法才能正确设置它们。不幸的是，S有那种味道。如果设置得太高，长时间运行的作业可能会陷入困境；太低，交互式作业可能无法获得适当的 CPU 份额。</p></li> <li><p>尝试#3：更好的计算</p> <p>现在，我们还有一个问题要解决：如何防止调度程序被玩弄？正如你可能已经猜到的，真正的罪魁祸首是Rule 4a 和 4b，它们允许作业在时间片到期前放弃 CPU，从而保留其优先级。那么我们该怎么办呢？解决办法是在 MLFQ 的每一级更好地计算 CPU 时间。调度程序不应该忘记进程在特定级别上使用了多少时间片，而应该进行跟踪；一旦进程用完了分配的时间片，就会被降级到下一个优先级队列。至于进程是在一个长的时间段内使用时间片，还是在许多小的时间段内使用时间片，这并不重要。因此，我们将规则 4a 和 4b 重写为以下单一规则：</p> <ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule 4: Once a job uses up its time allotment at a given level (re- gardless of how many times it has given up the CPU), its priority is reduced (i.e., it moves down one queue).</mtext></mrow><annotation encoding="application/x-tex">\text{Rule 4: Once a job uses up its time allotment at a given level (re-
  gardless of how many times it has given up the CPU), its priority is
  reduced (i.e., it moves down one queue).}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Rule 4: Once a job uses up its time allotment at a given level (re- gardless of how many times it has given up the CPU), its priority is reduced (i.e., it moves down one queue).</span></span></span></span></span></li></ul></li> <li><p>例子#3.1：旧规则和新规则对比</p> <p>下图显示了当工作负载试图利用旧规则 4a 和 4b（左侧）以及新的反玩弄规则 4 来玩弄调度程序时会发生的情况。如果没有任何防止玩弄的保护措施，进程可以在时间片结束前发出 I/O，从而支配 CPU 时间。有了这种保护措施，无论进程的 I/O 行为如何，它都会在队列中缓慢移动，从而无法获得不公平的 CPU 占有率。</p> <p><img src="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Gaming-Tolerance.png" alt="image-20240327125632640"></p> <img src="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Lower-Priority-Long-Quanta.png" alt="image-20240327125456705" style="zoom:50%;"></li> <li><p>调整 MLFQ 及其他问题</p> <p>MLFQ 调度还存在其他一些问题。一个大问题是如何为这样的调度器设置参数。例如，应该有多少个队列？每个队列的时间片应该有多大？为了避免饥饿并考虑到行为的变化，应该多久提升一次优先级？这些问题都没有简单的答案，因此只有在工作负载方面积累一定的经验，然后对调度程序进行调整，才能取得令人满意的平衡。</p> <p>例如，大多数 MLFQ 变体都允许在不同队列中使用不同的时间片长度。高优先级队列的时间片通常较短；毕竟它们由交互式作业组成，因此在它们之间快速交替是合理的（例如 10 毫秒或更少）。相比之下，低优先级队列包含的是占用 CPU 的长期运行作业；因此，较长的时间片（如 100 毫秒）也很有效。下图显示了一个例子，其中两个作业在最高队列运行 20 毫秒（时间片为 10 毫秒），在中间队列运行 40 毫秒（时间片为 20 毫秒），在最低队列运行 40 毫秒。</p> <img src="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Lower-Priority-Long-Quanta.png" alt="image-20240327125456705" style="zoom:50%;"> <p><strong>Solaris MLFQ</strong> 实现——分时调度类（TS）——特别容易配置；它提供了一组表，可以准确确定进程的优先级在其整个生命周期中如何更改、每个时间片的长度以及提高作业优先级的频率；管理员可以修改该表以使调度程序以不同的方式运行。该表的默认值为 60 个队列，时间片长度从 20 毫秒（最高优先级）缓慢增加到几百毫秒（最低），并且优先级大约每 1 秒左右提升一次。</p> <p>其他 MLFQ 调度器并不使用本章所述的表格或精确规则，而是使用数学公式来调整优先级。例如，FreeBSD 调度器（4.3 版）使用一个公式来计算作业当前的优先级，该公式基于进程使用了多少 CPU ；此外，使用率会随着时间的推移而衰减，从而以与本文所述不同的方式提供所需的优先级提升。最后，许多调度器还有一些你可能会遇到的其他功能。例如，有些调度器为操作系统工作保留最高优先级；因此，典型的用户作业永远无法获得系统中的最高优先级。有些系统还允许用户通过一些建议来帮助设置优先级；例如，通过使用命令行实用程序 nice，你可以（在一定程度上）提高或降低作业的优先级，从而增加或减少它在任何特定时间运行的机会。</p></li> <li><p>MLFQ总结</p> <p>我们已经描述了多级反馈队列（MLFQ）的调度方法。希望你现在能明白它为什么叫这个名字：它有多级队列，并使用反馈来确定给定作业的优先级。历史是它的指南：关注作业在一段时间内的表现，并相应地处理它们。在本章中，MLFQ 规则的精炼集在此重现，供大家欣赏：</p> <ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule 1: If Priority(A) &gt; Priority(B), A runs (B doesn’t).</mtext></mrow><annotation encoding="application/x-tex">\text{Rule 1: If Priority(A) &gt; Priority(B), A runs (B doesn’t).}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Rule 1: If Priority(A) &gt; Priority(B), A runs (B doesn’t).</span></span></span></span></span></li> <li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule 2: If Priority(A) = Priority(B), A and B run in round-robin fash- ion using the time slice (quantum length) of the given queue.</mtext></mrow><annotation encoding="application/x-tex">\text{Rule 2: If Priority(A) = Priority(B), A and B run in round-robin fash-
  ion using the time slice (quantum length) of the given queue.}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Rule 2: If Priority(A) = Priority(B), A and B run in round-robin fash- ion using the time slice (quantum length) of the given queue.</span></span></span></span></span></li> <li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule 3: When a job enters the system, it is placed at the highest priority (the topmost queue).</mtext></mrow><annotation encoding="application/x-tex">\text{Rule 3: When a job enters the system, it is placed at the highest
  priority (the topmost queue).}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Rule 3: When a job enters the system, it is placed at the highest priority (the topmost queue).</span></span></span></span></span></li> <li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule 4: Once a job uses up its time allotment at a given level (re- gardless of how many times it has given up the CPU), its priority is reduced (i.e., it moves down one queue).</mtext></mrow><annotation encoding="application/x-tex">\text{Rule 4: Once a job uses up its time allotment at a given level (re-
  gardless of how many times it has given up the CPU), its priority is
  reduced (i.e., it moves down one queue).}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Rule 4: Once a job uses up its time allotment at a given level (re- gardless of how many times it has given up the CPU), its priority is reduced (i.e., it moves down one queue).</span></span></span></span></span></li> <li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Rule 5: After some time period S, move all the jobs in the system to the topmost queue.</mtext></mrow><annotation encoding="application/x-tex">\text{Rule 5: After some time period S, move all the jobs in the system
  to the topmost queue.}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Rule 5: After some time period S, move all the jobs in the system to the topmost queue.</span></span></span></span></span></li></ul> <p>MLFQ 很有趣，原因如下：它不要求先验了解作业的性质，而是观察作业的执行情况并相应地确定其优先级。通过这种方式，它成功地实现了两全其美：它可以为短时间运行的交互式作业提供出色的整体性能（类似于 SJF/STCF），并且对于长时间运行的 CPU 密集型工作负载来说，它是公平的并取得进步。因此，许多系统，包括 BSD UNIX 衍生系统 、Solaris 以及 Windows NT 和后续的 Windows 操作系统，都使用某种形式的 MLFQ 作为其基本调度程序。</p></li></ul> <h2 id="_2-program-explanation"><a href="#_2-program-explanation" class="header-anchor">#</a> 2 Program Explanation</h2> <p>这个程序 mlfq.py 允许您查看本章中介绍的 MLFQ 调度程序的行为方式。和以前一样，您可以使用它来使用随机种子为自己生成问题，或者使用它构建一个精心设计的实验，以了解 MLFQ 在不同情况下的工作原理。要运行该程序，请键入：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>❯ python mlfq.py
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用参数-h查看选项帮助：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>❯ python mlfq.py -h
Usage: mlfq.py [options]

Options:
  -h, --help            show this help message and exit
  -s SEED, --seed=SEED  the random seed
  -n NUMQUEUES, --numQueues=NUMQUEUES
                        number of queues in MLFQ (if not using -Q)
  -q QUANTUM, --quantum=QUANTUM
                        length of time slice (if not using -Q)
  -a ALLOTMENT, --allotment=ALLOTMENT
                        length of allotment (if not using -A)
  -Q QUANTUMLIST, --quantumList=QUANTUMLIST
                        length of time slice per queue level, specified as
                        x,y,z,... where x is the quantum length for the
                        highest priority queue, y the next highest, and so
                        forth
  -A ALLOTMENTLIST, --allotmentList=ALLOTMENTLIST
                        length of time allotment per queue level, specified as
                        x,y,z,... where x is the # of time slices for the
                        highest priority queue, y the next highest, and so
                        forth
  -j NUMJOBS, --numJobs=NUMJOBS
                        number of jobs in the system
  -m MAXLEN, --maxlen=MAXLEN
                        max run-time of a job (if randomly generating)
  -M MAXIO, --maxio=MAXIO
                        max I/O frequency of a job (if randomly generating)
  -B BOOST, --boost=BOOST
                        how often to boost the priority of all jobs back to
                        high priority
  -i IOTIME, --iotime=IOTIME
                        how long an I/O should last (fixed constant)
  -S, --stay            reset and stay at same priority level when issuing I/O
  -I, --iobump          if specified, jobs that finished I/O move immediately
                        to front of current queue
  -l JLIST, --jlist=JLIST
                        a comma-separated list of jobs to run, in the form
                        x1,y1,z1:x2,y2,z2:... where x is start time, y is run
                        time, and z is how often the job issues an I/O request
  -c                    compute answers for me
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>使用模拟器有几种不同的方法，一种方法是生成一些随机作业，然后看看您是否可以弄清楚它们在给定 MLFQ 调度程序的情况下将如何表现。例如，如果您想创建随机生成的三作业工作负载，您只需运行</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>❯ python mlfq.py -j 3
Here is the list of inputs:
OPTIONS jobs 3
OPTIONS queues 3
OPTIONS allotments for queue  2 is   1
OPTIONS quantum length for queue  2 is  10
OPTIONS allotments for queue  1 is   1
OPTIONS quantum length for queue  1 is  10
OPTIONS allotments for queue  0 is   1
OPTIONS quantum length for queue  0 is  10
OPTIONS boost 0
OPTIONS ioTime 5
OPTIONS stayAfterIO False
OPTIONS iobump False


For each job, three defining characteristics are given:
  startTime : at what time does the job enter the system
  runTime   : the total CPU time needed by the job to finish
  ioFreq    : every ioFreq time units, the job issues an I/O
              (the I/O takes ioTime units to complete)

Job List:
  Job  0: startTime   0 - runTime  84 - ioFreq   7
  Job  1: startTime   0 - runTime  42 - ioFreq   3
  Job  2: startTime   0 - runTime  51 - ioFreq   4

Compute the execution trace for the given workloads.
If you would like, also compute the response and turnaround
times for each of the jobs.

Use the -c flag to get the exact results when you are finished.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>这会在具有多个默认设置的默认数量的队列上生成三个作业（根据指定）的随机工作负载。如果您使用 (-c) 上的求解选项再次运行，您将看到与上面相同的打印输出，以及以下内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Execution Trace:

[ time 0 ] JOB BEGINS by JOB 0
[ time 0 ] JOB BEGINS by JOB 1
[ time 0 ] JOB BEGINS by JOB 2
[ time 0 ] Run JOB 0 at PRIORITY 2 [ TICKS 9 ALLOT 1 TIME 83 (of 84) ]
[ time 1 ] Run JOB 0 at PRIORITY 2 [ TICKS 8 ALLOT 1 TIME 82 (of 84) ]
[ time 2 ] Run JOB 0 at PRIORITY 2 [ TICKS 7 ALLOT 1 TIME 81 (of 84) ]
[ time 3 ] Run JOB 0 at PRIORITY 2 [ TICKS 6 ALLOT 1 TIME 80 (of 84) ]
[ time 4 ] Run JOB 0 at PRIORITY 2 [ TICKS 5 ALLOT 1 TIME 79 (of 84) ]
[ time 5 ] Run JOB 0 at PRIORITY 2 [ TICKS 4 ALLOT 1 TIME 78 (of 84) ]
[ time 6 ] Run JOB 0 at PRIORITY 2 [ TICKS 3 ALLOT 1 TIME 77 (of 84) ]
[ time 7 ] IO_START by JOB 0
IO DONE
[ time 7 ] Run JOB 1 at PRIORITY 2 [ TICKS 9 ALLOT 1 TIME 41 (of 42) ]
[ time 8 ] Run JOB 1 at PRIORITY 2 [ TICKS 8 ALLOT 1 TIME 40 (of 42) ]
[ time 9 ] Run JOB 1 at PRIORITY 2 [ TICKS 7 ALLOT 1 TIME 39 (of 42) ]
...

Final statistics:
  Job  0: startTime   0 - response   0 - turnaround 175
  Job  1: startTime   0 - response   7 - turnaround 191
  Job  2: startTime   0 - response   9 - turnaround 168

  Avg  2: startTime n/a - response 5.33 - turnaround 178.00
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>该跟踪以毫秒为单位准确显示了调度程序决定执行的操作。在此示例中，它首先运行作业 0 7 毫秒，直到作业 0 发出 I/O；这是完全可以预测的，因为作业 0 的 I/O 频率设置为 7 ms，这意味着它每运行 7 ms，就会发出一个 I/O 并等待其完成后再继续。此时，调度程序切换到作业 1，该作业在发出 I/O 之前仅运行 2 毫秒。调度程序以这种方式打印整个执行跟踪，最后还计算每个作业的响应时间和周转时间以及平均值。</p> <p>您还可以控制模拟的各个其他方面。例如，您可以指定系统中希望有多少个队列 (-n) 以及所有这些队列的时间片长度应该是多少 (-q)；如果您想要更多的控制和每个队列不同的时间片长度，您可以使用 -Q 指定每个队列的时间片的长度，例如， -Q 10,20,30] 模拟具有三个队列的调度程序，最高优先级队列具有 10 毫秒时间片，次高优先级队列具有 20 毫秒时间片，低优先级队列具有 30 毫秒时间片。</p> <p>您也可以单独控制每个队列的时间分配量。可以使用 -a 对所有队列进行设置，或使用 -A 对每个队列进行设置，例如 -A 20,40,60 将每个队列的时间分配分别设置为 20ms、40ms 和 60ms。请注意，虽然本章讨论的是时间方面的分配，但这里是根据时间片的数量来完成的，即，如果给定队列的时间片长度为 10 毫秒，并且分配为 2，则作业可以运行在优先级下降之前，在该队列级别持续 2 个时间片（20 毫秒）。</p> <p>如果您随机生成作业，您还可以控制它们运行的​​时间 (-m) 或它们生成 I/O 的频率 (-M)。但是，如果您希望更多地控制系统中运行的作业的确切特征，则可以使用 -l（小写 L）或 --jlist，它允许您指定要模拟的确切作业集。该列表的格式为：x1,y1,z1:x2,y2,z2:... 其中 x 是作业的开始时间，y 是运行时间（即需要多少 CPU 时间），z I/O 频率（即运行 z ms 后，作业发出 I/O；如果 z 为 0，则不发出 I/O）。
例如，如果您想重新创建图 8.3 中的示例，您可以指定一个作业列表，如下所示：
<code>python mlfq.py --jlist 0,180,0:100,20,0 -q 10</code></p> <p>以这种方式运行模拟器会创建一个三级 MLFQ，每个级别都有 10 毫秒的时间片。创建了两个作业：作业 0 在时间 0 启动，总共运行 180 毫秒，并且从不发出 I/O；作业 1 从 100 毫秒开始，仅需要 20 毫秒的 CPU 时间即可完成，而且从不发出 I/O。</p> <p>最后，还有另外三个令人感兴趣的参数。 -B 参数如果设置为非零值，则在调用时每 N 毫秒将所有作业提升到最高优先级队列：</p> <p>调度程序使用此功能来避免饥饿，如本章中所讨论的。但是，默认情况下它是关闭的。</p> <p>-S 标志调用旧规则 4a 和 4b，这意味着如果作业在完成其时间片之前发出 I/O，则当它恢复执行时，它将返回到相同的优先级队列，并且其完整分配完好无损。这可以玩弄调度器。</p> <p>最后，您可以使用 -i 标志轻松更改 I/O 持续的时间。默认情况下，在此简单模型中，每个 I/O 需要 5 毫秒的固定时间或使用此标志设置的任何时间。</p> <p>您还可以使用 -I 标志尝试将刚刚完成 I/O 的作业移动到它们所在队列的头部还是后面。看看吧，很好玩！</p> <h2 id="_3-qa"><a href="#_3-qa" class="header-anchor">#</a> 3 QA</h2> <ol><li>仅使用两个作业和两个队列运行一些随机生成的问题；计算每个的 MLFQ 执行轨迹。通过限制每个作业的长度和关闭 I/O 让您的生活更轻松。
<blockquote><p>例子：<code>python mlfq.py -n 2 -j 2 -m 20 -M 0 -s 66</code>
Job List:
Job  0: startTime   0 - runTime   2 - ioFreq   0
Job  1: startTime   0 - runTime   5 - ioFreq   0
Execution Trace:
[ time 0 ] JOB BEGINS by JOB 0
[ time 0 ] JOB BEGINS by JOB 1
[ time 0 ] Run JOB 0 at PRIORITY 1 [ TICKS 9 ALLOT 1 TIME 1 (of 2) ]
[ time 1 ] Run JOB 0 at PRIORITY 1 [ TICKS 8 ALLOT 1 TIME 0 (of 2) ]
[ time 2 ] FINISHED JOB 0
[ time 2 ] Run JOB 1 at PRIORITY 1 [ TICKS 9 ALLOT 1 TIME 4 (of 5) ]
[ time 3 ] Run JOB 1 at PRIORITY 1 [ TICKS 8 ALLOT 1 TIME 3 (of 5) ]
[ time 4 ] Run JOB 1 at PRIORITY 1 [ TICKS 7 ALLOT 1 TIME 2 (of 5) ]
[ time 5 ] Run JOB 1 at PRIORITY 1 [ TICKS 6 ALLOT 1 TIME 1 (of 5) ]
[ time 6 ] Run JOB 1 at PRIORITY 1 [ TICKS 5 ALLOT 1 TIME 0 (of 5) ]
[ time 7 ] FINISHED JOB 1
Final statistics:
Job  0: startTime   0 - response   0 - turnaround   2
Job  1: startTime   0 - response   2 - turnaround   7
Avg  1: startTime n/a - response 1.00 - turnaround 4.50</p></blockquote></li> <li>您将如何运行调度程序来重现本章中的每个示例？
<blockquote><p>// Figure 8.2 Long-running Job Over Time
<code>&gt;python mlfq.py -n 3 -q 10 -l 0,200,0 -c</code>
// Figure 8.3 Along Came An Interactive Job
<code>&gt;python mlfq.py -n 3 -q 10 -l 0,180,0:100,20,0 -c</code>
// Figure 8.4 A Mixed I/O-intensive and CPU-intensive Workload
<code>&gt;python mlfq.py -n 3 -q 10 -l 0,175,0:50,25,1 -i 5 -S -c</code>
// Figure 8.5 without priority boost
<code>&gt;python mlfq.py -n 3 -q 10 -l 0,120,0:100,50,1:100,50,1 -i 1 -S -c</code>
// Figure 8.5 with priority boost
<code>python mlfq.py -n 3 -q 10 -l 0,120,0:100,50,1:100,50,1 -i 1 -S -B 50 -c</code>
// Figure 8.6 without gaming tolerance
<code>&gt; python mlfq.py -n 3 -q 10 -i 1 -S -l 0,200,0:80,100,9 -c</code>
// Figure 8.6 with gaming tolerance
<code>python mlfq.py -n 3 -q 10 -i 1 -l 0,200,0:80,100,9 -c</code>
// Figure 8.7 Lower Priority, Longer Quanta
<code>python mlfq.py -n 3 -a 2 -Q 10,20,40 -l 0,200,0:0,200,0 -c</code></p></blockquote></li> <li>如何配置调度程序参数以使其像循环调度程序一样运行？
<blockquote><p>同一队列上的作业是按时间分片的，因此答案是只有一个队列。</p></blockquote></li> <li>使用两个作业和调度程序参数制作一个工作负载，以便一个作业利用旧的规则 4a 和 4b（使用 -S 参数打开）来欺骗调度程序并在特定的情况下获得 99% 的 CPU 占用率时间间隔。
<blockquote><p>首先，使用 -i 将 I/O 时间设置为 1，然后确保 CPU hog 在 100 个点击时间片长度的第 99 个点击时调用 I/O 操作。另外，包含 -I 标志以确保 CPU 占用者在 I/O 请求完成时重新获得控制权： <code>python mlfq.py -S -i 1 -l 0,297,99:0,60,0 -q 100 -n 3 -I -c</code></p></blockquote></li> <li>给定一个系统，其最高队列的时间片长度为 10 毫秒，您需要多久将作业提升回最高优先级（使用 -B 标志）才能保证单个长时间运行的作业（并且可能会饥饿）作业至少获得 5% 的 CPU 资源？
<blockquote><p>如果每 10 毫秒就有一个新的 10 毫秒长作业到达 - 如图 8.5（左）所示，每 200 个时钟周期提升可确保长进程将运行 10/200 个 CPU 周期 = 5%。</p></blockquote></li> <li>调度中出现的一个问题是在队列的哪一端添加刚刚完成 I/O 的作业； -I 参数更改此调度模拟器的此行为。尝试一些工作负载，看看是否可以看到此参数的效果。<div class="language-shell line-numbers-mode"><pre class="language-shell"><code>python mlfq.py <span class="token parameter variable">-n</span> <span class="token number">2</span> <span class="token parameter variable">-q</span> <span class="token number">10</span> <span class="token parameter variable">-l</span> <span class="token number">0,50</span>,0:0,50,11 <span class="token parameter variable">-i</span> <span class="token number">1</span> <span class="token parameter variable">-S</span> <span class="token parameter variable">-c</span>
python mlfq.py <span class="token parameter variable">-n</span> <span class="token number">2</span> <span class="token parameter variable">-q</span> <span class="token number">10</span> <span class="token parameter variable">-l</span> <span class="token number">0,50</span>,0:0,50,11 <span class="token parameter variable">-i</span> <span class="token number">1</span> <span class="token parameter variable">-S</span> <span class="token parameter variable">-I</span> <span class="token parameter variable">-c</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div>使用<code>-I</code>的周转时间下降了很多。</li></ol></div></div> <div class="page-slot page-slot-bottom"><div class="donation">
      <button>打赏</button>
      <div class="main">
        <div class="pic">
          <img src="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/wechatpay.jpeg" alt="微信">
          <img src="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/zhifubaopay.jpeg" alt="支付宝">
        </div>
      </div>  
    </div></div> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=OS" title="标签">#OS</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/05/11, 20:33:38</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/f0c724/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">CPU调度</div></a> <a href="/pages/40a229/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">比例份额调度</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/f0c724/" class="prev">CPU调度</a></span> <span class="next"><a href="/pages/40a229/">比例份额调度</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/04d466/"><div>
            计算机网络 面试题目总结
            <!----></div></a> <span class="date">06-02</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/6eacac/"><div>
            数据结构与算法 面试题目总结
            <!----></div></a> <span class="date">06-01</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/c513f0/"><div>
            C/C++ 面试题目总结
            <!----></div></a> <span class="date">06-01</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:unique.hzf@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/unique-pure" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://pursuit.blog.csdn.net/" title="My CSDN" target="_blank" class="iconfont icon-csdn"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2020-2024
    <span>Pursuit | <a href="https://github.com/unique-pure/my-vdoing-blog-template/blob/main/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><!----><div></div><WebInfo></WebInfo><PageInfo></PageInfo><div></div></div></div>
    <script src="/assets/js/app.81b3082f.js" defer></script><script src="/assets/js/4.71a85121.js" defer></script><script src="/assets/js/1.4a1189e9.js" defer></script><script src="/assets/js/3.bca043f9.js" defer></script><script src="/assets/js/106.a6484004.js" defer></script><script src="/assets/js/20.bc1029fc.js" defer></script>
  </body>
</html>
